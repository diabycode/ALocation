{% extends "alocation/generic-page.html" %}
{% load static %}

{% block head_content %}
    <title>AlmamyLocation</title>

    <!-- styles -->
    <link rel="stylesheet" href="{% static 'css/renter/list-style.css' %}">

{% endblock %}


{% block body_content %}
    <nav>
        <ul>
            <li><a href="{% url 'renter:renters-list' %}">Locataires</a></li>
            <li><a href="{% url 'local:locals-list' %}">Locaux</a></li>
        </ul>
    </nav>

    <div class="search-form">
        <form method="GET">
            <input type="text" name="search-query" value="{% if search_query %}{{ search_query }}{% endif%}" placeholder="nom, prénom, local">
            <input type="submit" value="RECHERCHE" class="blue">
        </form>
    </div>

    <div class="action-bar">
        <div>
            <a href="{% url 'renter:add' %}">
                <svg width="25" height="23" viewBox="0 0 25 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19.7916 12.4583H13.5416V18.2083H11.4583V12.4583H5.20831V10.5416H11.4583V4.79163H13.5416V10.5416H19.7916V12.4583Z" fill="#F9F9F9"/>
                </svg>
            </a>
            <a href="#">
                <svg width="25" height="23" viewBox="0 0 25 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21.0938 10.0625V18.6875C21.0938 19.0687 20.9291 19.4343 20.6361 19.7039C20.3431 19.9735 19.9457 20.125 19.5312 20.125H5.46875C5.05435 20.125 4.65692 19.9735 4.3639 19.7039C4.07087 19.4343 3.90625 19.0687 3.90625 18.6875V10.0625C3.90625 9.68121 4.07087 9.31557 4.3639 9.04599C4.65692 8.77641 5.05435 8.62496 5.46875 8.62496H7.8125C8.0197 8.62496 8.21841 8.70068 8.36493 8.83547C8.51144 8.97026 8.59375 9.15308 8.59375 9.34371C8.59375 9.53433 8.51144 9.71715 8.36493 9.85194C8.21841 9.98673 8.0197 10.0625 7.8125 10.0625H5.46875V18.6875H19.5312V10.0625H17.1875C16.9803 10.0625 16.7816 9.98673 16.6351 9.85194C16.4886 9.71715 16.4062 9.53433 16.4062 9.34371C16.4062 9.15308 16.4886 8.97026 16.6351 8.83547C16.7816 8.70068 16.9803 8.62496 17.1875 8.62496H19.5312C19.9457 8.62496 20.3431 8.77641 20.6361 9.04599C20.9291 9.31557 21.0938 9.68121 21.0938 10.0625ZM9.14648 6.25847L11.7188 3.89109V12.2187C11.7188 12.4093 11.8011 12.5921 11.9476 12.7269C12.0941 12.8617 12.2928 12.9375 12.5 12.9375C12.7072 12.9375 12.9059 12.8617 13.0524 12.7269C13.1989 12.5921 13.2812 12.4093 13.2812 12.2187V3.89109L15.8535 6.25847C16.0001 6.39334 16.1989 6.4691 16.4062 6.4691C16.6136 6.4691 16.8124 6.39334 16.959 6.25847C17.1056 6.1236 17.1879 5.94069 17.1879 5.74996C17.1879 5.55922 17.1056 5.37631 16.959 5.24144L13.0527 1.64769C12.9802 1.58086 12.894 1.52785 12.7992 1.49168C12.7043 1.45551 12.6027 1.43689 12.5 1.43689C12.3973 1.43689 12.2957 1.45551 12.2008 1.49168C12.106 1.52785 12.0198 1.58086 11.9473 1.64769L8.04102 5.24144C7.89442 5.37631 7.81207 5.55922 7.81207 5.74996C7.81207 5.94069 7.89442 6.1236 8.04102 6.25847C8.18761 6.39334 8.38643 6.4691 8.59375 6.4691C8.80107 6.4691 8.99989 6.39334 9.14648 6.25847Z" fill="#F9F9F9"/>
                </svg>
            </a>
        </div>
        <div>
            <span>
                <svg width="20" height="18" viewBox="0 0 20 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11.6667 9V14.91C11.7 15.135 11.6167 15.375 11.425 15.5325C11.3479 15.602 11.2563 15.6572 11.1555 15.6948C11.0547 15.7325 10.9466 15.7518 10.8375 15.7518C10.7284 15.7518 10.6203 15.7325 10.5195 15.6948C10.4187 15.6572 10.3271 15.602 10.25 15.5325L8.575 14.025C8.48411 13.945 8.41501 13.8472 8.37308 13.7392C8.33116 13.6313 8.31756 13.516 8.33334 13.4025V9H8.30834L3.50834 3.465C3.37301 3.30865 3.31195 3.11044 3.33849 2.9137C3.36504 2.71695 3.47703 2.53766 3.65 2.415C3.80834 2.31 3.98334 2.25 4.16667 2.25H15.8333C16.0167 2.25 16.1917 2.31 16.35 2.415C16.523 2.53766 16.635 2.71695 16.6615 2.9137C16.6881 3.11044 16.627 3.30865 16.4917 3.465L11.6917 9H11.6667Z" fill="#6C6C6C"/>
                </svg>
                Filtrer
            </span>
            <span>
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M2.88667 17.1125C4.10834 18.3333 6.07167 18.3333 10 18.3333C13.9283 18.3333 15.8925 18.3333 17.1125 17.1125C18.3333 15.8933 18.3333 13.9283 18.3333 9.99996C18.3333 6.07163 18.3333 4.10746 17.1125 2.88663C15.8933 1.66663 13.9283 1.66663 10 1.66663C6.07167 1.66663 4.10751 1.66663 2.88667 2.88663C1.66667 4.10829 1.66667 6.07163 1.66667 9.99996C1.66667 13.9283 1.66667 15.8925 2.88667 17.1125ZM12.2917 13.3333C12.2917 13.4991 12.2258 13.658 12.1086 13.7752C11.9914 13.8924 11.8324 13.9583 11.6667 13.9583H8.33334C8.16758 13.9583 8.00861 13.8924 7.8914 13.7752C7.77419 13.658 7.70834 13.4991 7.70834 13.3333C7.70834 13.1675 7.77419 13.0086 7.8914 12.8914C8.00861 12.7741 8.16758 12.7083 8.33334 12.7083H11.6667C11.8324 12.7083 11.9914 12.7741 12.1086 12.8914C12.2258 13.0086 12.2917 13.1675 12.2917 13.3333ZM13.3333 10.625C13.4991 10.625 13.6581 10.5591 13.7753 10.4419C13.8925 10.3247 13.9583 10.1657 13.9583 9.99996C13.9583 9.8342 13.8925 9.67523 13.7753 9.55802C13.6581 9.44081 13.4991 9.37496 13.3333 9.37496H6.66667C6.50091 9.37496 6.34194 9.44081 6.22473 9.55802C6.10752 9.67523 6.04167 9.8342 6.04167 9.99996C6.04167 10.1657 6.10752 10.3247 6.22473 10.4419C6.34194 10.5591 6.50091 10.625 6.66667 10.625H13.3333ZM15.625 6.66663C15.625 6.83239 15.5592 6.99136 15.4419 7.10857C15.3247 7.22578 15.1658 7.29163 15 7.29163H5.00001C4.83424 7.29163 4.67527 7.22578 4.55806 7.10857C4.44085 6.99136 4.37501 6.83239 4.37501 6.66663C4.37501 6.50087 4.44085 6.34189 4.55806 6.22468C4.67527 6.10747 4.83424 6.04163 5.00001 6.04163H15C15.1658 6.04163 15.3247 6.10747 15.4419 6.22468C15.5592 6.34189 15.625 6.50087 15.625 6.66663Z" fill="#6C6C6C"/>
                </svg>
                Trier
            </span>
            <select name="sort-by" id="sort-by">
                <option value="" selected>aucun</option>
                <option value="last_name">nom</option>
                <option value="first_name">prénom</option>
                <option value="address">adresse</option>
            </select>
        </div>
    </div>

    <div class="renter list-table">
        {% if page_obj %}
            <table>
                <thead>
                    <tr>
                        <th>N°</th>
                        <th>Nom</th>
                        <th>Prénom</th>
                        <th>Local(aux)</th>
                        <th>Téléphone</th>
                        <th>Adresse</th>
                        <th>Retard(s) sur paiement</th>
                        <!-- <th></th> -->
                    </tr>
                </thead>
                <tbody>
                    {% for renter in page_obj %}
                
                        <tr>
                            <td> {{ forloop.counter }} </td>
                            <td> {{ renter.last_name }} </td>
                            <td> {{ renter.first_name }} </td>
                            <td> 
                                {% if renter.get_all_locals %}
                                    {% for l in renter.get_all_locals %} 
                                        {{ l.tag_name }},
                                    {% endfor %}
                                {% else %}
                                    - 
                                {% endif %} 
                            </td>
                            <td> {% if renter.phone %} {{ renter.phone }} {% else %} - {% endif %}  </td>
                            <td> {% if renter.address %} {{ renter.address|truncatechars:15 }} {% else %} - {% endif %} </td>
                            <td> {{ renter.unpaid_payment_count }} </td>
                            <td class="raw-action-links">
                                <a href="{% url 'renter:edit' pk=renter.pk %}">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18.988 2.01196L21.988 5.01196L19.701 7.29996L16.701 4.29996L18.988 2.01196ZM8 16H11L18.287 8.71296L15.287 5.71296L8 13V16Z" fill="#2C659E"/>
                                        <path d="M19 19H8.158C8.132 19 8.105 19.01 8.079 19.01C8.046 19.01 8.013 19.001 7.979 19H5V5H11.847L13.847 3H5C3.897 3 3 3.896 3 5V19C3 20.104 3.897 21 5 21H19C19.5304 21 20.0391 20.7893 20.4142 20.4142C20.7893 20.0391 21 19.5304 21 19V10.332L19 12.332V19Z" fill="#2C659E"/>
                                    </svg>
                                </a>
                                <a href="{% url 'renter:renter-details' pk=renter.pk %}" > 
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M3 20V18H21V20H3ZM3 6V4H21V6H3ZM5 16C4.45 16 3.979 15.804 3.587 15.412C3.195 15.02 2.99934 14.5493 3 14V10C3 9.45 3.196 8.979 3.588 8.587C3.98 8.195 4.45067 7.99933 5 8H19C19.55 8 20.021 8.196 20.413 8.588C20.805 8.98 21.0007 9.45067 21 10V14C21 14.55 20.804 15.021 20.412 15.413C20.02 15.805 19.5493 16.0007 19 16H5ZM5 14H19V10H5V14Z" fill="#2C659E"/>
                                    </svg>
                                </a>
                                <a href="{% url 'renter:delete' pk=renter.pk %}">
                                    <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M9.16668 5.50004H12.8333C12.8333 5.01381 12.6402 4.54749 12.2964 4.20368C11.9526 3.85986 11.4862 3.66671 11 3.66671C10.5138 3.66671 10.0475 3.85986 9.70365 4.20368C9.35983 4.54749 9.16668 5.01381 9.16668 5.50004ZM7.33334 5.50004C7.33334 4.52758 7.71965 3.59495 8.40728 2.90732C9.09492 2.21968 10.0275 1.83337 11 1.83337C11.9725 1.83337 12.9051 2.21968 13.5927 2.90732C14.2804 3.59495 14.6667 4.52758 14.6667 5.50004H19.25C19.4931 5.50004 19.7263 5.59662 19.8982 5.76853C20.0701 5.94043 20.1667 6.17359 20.1667 6.41671C20.1667 6.65982 20.0701 6.89298 19.8982 7.06489C19.7263 7.2368 19.4931 7.33337 19.25 7.33337H18.4415L17.6293 16.8117C17.5513 17.727 17.1325 18.5796 16.4559 19.2009C15.7793 19.8221 14.8941 20.1668 13.9755 20.1667H8.02451C7.10593 20.1668 6.22076 19.8221 5.54415 19.2009C4.86753 18.5796 4.44876 17.727 4.37068 16.8117L3.55851 7.33337H2.75001C2.5069 7.33337 2.27374 7.2368 2.10183 7.06489C1.92992 6.89298 1.83334 6.65982 1.83334 6.41671C1.83334 6.17359 1.92992 5.94043 2.10183 5.76853C2.27374 5.59662 2.5069 5.50004 2.75001 5.50004H7.33334ZM13.75 11C13.75 10.7569 13.6534 10.5238 13.4815 10.3519C13.3096 10.18 13.0765 10.0834 12.8333 10.0834C12.5902 10.0834 12.3571 10.18 12.1852 10.3519C12.0133 10.5238 11.9167 10.7569 11.9167 11V14.6667C11.9167 14.9098 12.0133 15.143 12.1852 15.3149C12.3571 15.4868 12.5902 15.5834 12.8333 15.5834C13.0765 15.5834 13.3096 15.4868 13.4815 15.3149C13.6534 15.143 13.75 14.9098 13.75 14.6667V11ZM9.16668 10.0834C9.40979 10.0834 9.64295 10.18 9.81486 10.3519C9.98677 10.5238 10.0833 10.7569 10.0833 11V14.6667C10.0833 14.9098 9.98677 15.143 9.81486 15.3149C9.64295 15.4868 9.40979 15.5834 9.16668 15.5834C8.92356 15.5834 8.6904 15.4868 8.5185 15.3149C8.34659 15.143 8.25001 14.9098 8.25001 14.6667V11C8.25001 10.7569 8.34659 10.5238 8.5185 10.3519C8.6904 10.18 8.92356 10.0834 9.16668 10.0834ZM6.19668 16.6559C6.23573 17.1137 6.44525 17.5401 6.78375 17.8508C7.12225 18.1614 7.56506 18.3337 8.02451 18.3334H13.9755C14.4346 18.3332 14.877 18.1608 15.2151 17.8501C15.5532 17.5395 15.7625 17.1133 15.8015 16.6559L16.6008 7.33337H5.39918L6.19668 16.6559Z" fill="#C95F4F"/>
                                    </svg>
                                </a>
                            </td>
                        </tr>
        
                    {% endfor  %}
                    
                </tbody>
            </table>

            <div class="pagination">
                <span class="step-links">

                    <!-- previous  -->
                    <div class="{% if page_obj.has_previous %} prev active {% else %} prev disable {% endif %}">
                        <a href="?page=1">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.75 17.5001L2.5 17.5001L2.5 2.50012L3.75 2.50012L3.75 17.5001ZM17.5 2.50012L17.5 17.5001L6.875 10.0001L17.5 2.50012ZM16.25 15.088L16.25 4.91223L9.04297 10.0001L16.25 15.088Z" fill="#F9F9F9"/>
                            </svg>
                        </a>
                        <a href="?page={% if page_obj.has_previous %}{{ page_obj.previous_page_number }}{% else %}1{% endif %}">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12.5 15L7.5 10L12.5 5" stroke="#F9F9F9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </div>


                    <!-- next -->
                    <div class="{% if page_obj.has_next %} next active {% else %} next disable {% endif %}">
                        <a href="?page={% if page_obj.has_next %}{{ page_obj.next_page_number }}{% else %}{{ page_obj.paginator.num_pages }}{% endif %}">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M7.5 5L12.5 10L7.5 15" stroke="#F9F9F9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                        <a href="?page={{ page_obj.paginator.num_pages }}">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M16.25 2.50012H17.5V17.5001H16.25V2.50012ZM2.5 17.5001V2.50012L13.125 10.0001L2.5 17.5001ZM3.75 4.91223V15.088L10.957 10.0001L3.75 4.91223Z" fill="#F9F9F9"/>
                            </svg>
                        </a>
                    </div>


                    <span class="current">
                        Page {{ page_obj.number }}/{{ page_obj.paginator.num_pages }}
                    </span>
                </span>
            </div> 

        {% else %}
            <p>Aucune données</p>
        {% endif %}
    </div>
{% endblock %}



    
